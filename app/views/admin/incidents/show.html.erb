<div class="max-w-3xl mx-auto">
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-bold text-gray-900 dark:text-gray-50 tracking-tight"><%= @incident.title %></h1>
      <div class="flex items-center space-x-2 mt-2">
        <%= severity_badge(@incident.severity) %>
        <%= incident_status_badge(@incident.status) %>
      </div>
    </div>
    <div class="flex space-x-3">
      <% unless @incident.resolved? %>
        <%= button_to "Resolve", resolve_admin_incident_path(@incident), method: :patch, class: "btn-success" %>
      <% end %>
      <%= link_to "Edit", edit_admin_incident_path(@incident), class: "btn-secondary" %>
      <%= link_to "Back", admin_incidents_path, class: "btn-secondary" %>
    </div>
  </div>

  <div class="card p-6 mb-6">
    <dl class="grid grid-cols-2 gap-4">
      <div>
        <dt class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Started</dt>
        <dd class="mt-1 text-sm text-gray-900 dark:text-gray-100"><%= @incident.created_at.strftime("%b %d, %Y at %I:%M %p") %></dd>
      </div>
      <div>
        <dt class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Resolved</dt>
        <dd class="mt-1 text-sm text-gray-900 dark:text-gray-100"><%= @incident.resolved_at ? @incident.resolved_at.strftime("%b %d, %Y at %I:%M %p") : "Ongoing" %></dd>
      </div>
      <% if @incident.site_monitors.any? %>
        <div class="col-span-2">
          <dt class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Affected Monitors</dt>
          <dd class="mt-1 text-sm text-gray-900 dark:text-gray-100"><%= @incident.site_monitors.pluck(:name).join(", ") %></dd>
        </div>
      <% end %>
    </dl>
  </div>

  <% unless @incident.resolved? %>
    <div class="card p-6 mb-6">
      <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Post Update</h2>
      <%= render "update_form", incident: @incident, incident_update: @incident_update %>
    </div>
  <% end %>

  <div class="card p-6">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Timeline</h2>
    <% if @incident.incident_updates.any? %>
      <div class="space-y-4" id="incident_updates">
        <% @incident.incident_updates.each do |update| %>
          <%= render "incident_update", incident_update: update %>
        <% end %>
      </div>
    <% else %>
      <p class="text-sm text-gray-500 dark:text-gray-400">No updates yet.</p>
    <% end %>
  </div>
</div>
